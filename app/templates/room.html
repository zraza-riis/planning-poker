{% extends 'base.html' %}

{% block content %}
<div class="container mt-5">
    <h1>You have joined room {{ room.name }}</h1>
    <h4>Invite your team members with the following link: {{ room.join_link }}</h4>
    <h5>Connected Users: {{ room.players }}</h5>

    <form id="promptForm">
        <input type="text" id="promptInput" placeholder="Enter your prompt" required>
        <button type="submit">Submit</button>
    </form>

    <script type="text/javascript">
        var socket = io.connect();
    
        socket.on('connect', function() {
            console.log('Connected to server');
        });
    
        socket.on('disconnect', function() {
            console.log('Disconnected from server');
        });
    
        socket.on('new_room', function(data) {
            console.log('New room created:', data.room_uuid);
        });

        // Handle a new Prompt getting created
        socket.on('new_prompt', function(data) {
            console.log('New prompt submitted:', data.prompt_title);
        });

        document.getElementById('promptForm').addEventListener('submit', function(event) {
            event.preventDefault();

            var promptInput = document.getElementById('promptInput').value;

            socket.emit('new_prompt', {'room_uuid': '{{ room.uuid }}', 'prompt_title': promptInput});

            document.getElementById('promptInput').value = '';

        });

        
    </script>

</div>
{% endblock %}